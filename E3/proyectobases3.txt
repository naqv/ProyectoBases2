-- 1 n… en el lado de n tengo que colocar un foreng key
--- 1 1…cualquiera
--- n m no tengo que colocar nada.

CREATE OR REPLACE TYPE telefono_t AS OBJECT(codigo NUMBER(3),numero NUMBER(7));

CREATE TABLE telefonos_tab OF telefono_t;

CREATE OR REPLACE TYPE coordenada_t AS OBJECT(angulo NUMERIC(20),minuto NUMERIC(20),segundo NUMERIC(20));

CREATE TABLE coordenada_table OF coordenada_t;  

CREATE OR REPLACE TYPE ruta_t AS OBJECT(nombre VARCHAR(100),inicioLatitud coordenada_t,inicioLongitud coordenada_t,finLatitud coordenada_t,finLongitud coordenada_t,cantidadVisitas INTEGER(20),tipo VARCHAR(20),propuestaFija NUMBER(2),fechaIngreso DATE,descripcion VARCHAR(500));
  
 -- incluye REF paquete -- Puede ser null, esto hay que ponerlo luego. Falta esto.
 
CREATE TABLE ruta_table OF ruta_t(PRIMARY KEY(nombre),CONSTRAINT cont_tip CHECK(tipo IN('dinamica','fija')));
 
 
 CREATE OR REPLACE TYPE hito_t AS OBJECT(
  nombre       VARCHAR(100),
  latitud      coordenada_t,
  longitud     coordenada_t,
  altitud      coordenada_t,
  descripcion  VARCHAR(500),-- Seria bueno text, pero no lo quiere agarrar
  estado       VARCHAR(50),
  --categoria    VARCHAR(50) AQUI FALTA VER COMO SON LOS CONTRAINT DE COSAS QUE DEBERIAN SER ARRAYS
  edadApropiada   INTEGER(10),
  paginaweb      VARCHAR(30),
  telefono       telefono_t,
  email          VARCHAR(50),
  rutaEn REF ruta_t);
  
  -- tarifadescuent    
  --costoTicketMonedaLocal .
  --fotoDireccion
  --horario        ....
  --contiene REF hito_t,

   
 CREATE TABLE hito_table OF hito_t(CONSTRAINT cont_estado CHECK(estado IN('disponible','en reparacion','clausurado temporalmente')),PRIMARY KEY(nombre),foreing key(nombre) REFERENCES ruta_table(nombre) ON DELETE CASCADE);
 
 
 
 
 
 
 
 


CREATE OR REPLACE TYPE via_t AS OBJECT(
  nombre           VARCHAR(100),
  tipo             VARCHAR(50),
 -- tiposTransporte   (multivaluado) MANEJO DE ARRAYS...
  inicioLatitud     coordenada_t,
  inicioLongitud    coordenada_t,
  finLatitud        coordenada_t,
  finLongintud      coordenada_t,
  Es            REF hito_t);
  
 CREATE TABLE via_table OF via_t(
 
 CONSTRAINT cont_tipvia CHECK(tipo IN('calle','avenida','caminerıa','autopista','elevado','camino','puente')),
 FOREING key(Es) references hito_table);
 
 
 
 
  

  
  

  
  
  
  
  CREATE OR REPLACE TYPE Evento_t AS OBJECT( 
  nombre  VARCHAR(100),
  categoria VARCHAR(100),    
  --costoMonedaLocal
  descripcion  TEXT
  ocurre REF hito_t

  CONSTRAINT cont_eventocat CHECK( categoría IN (musical, entretenimiento, cultural, historico, social,festivo.))
 );
  
  CREATE TABLE evento_table OF Evento_t
  FOREING key(ocurre) references hito_table

;
  
  CREATE OR REPLACE TYPE AS Ciudad_t AS OBJECT (
  nombre  VARCHAR(100),
  pais    VARCHAR(100),
  nombreMonedaLocal VARCHAR(30),
  relacionLocalUSD  NUMERIC(30)
  estaEn REF ruta_t
  seEncuentraEn REF via_t
  

 
  );
  
  CREATE TABLE ciudad_table OF Ciudad_t
  FOREING KEY (estaEn) references ruta_table
  FOREING KEY( seEncuentraEn) references Ciudad_table;


  CREATE OR REPLACE TYPE Servicio_T AS OBJECT (  
  nombre  VARCHAR(100),
  categoria VARCHAR(100),
  numeroDeContacto telefono_t,
  emaill
  paginaweb
  descripcion TEXT
  direccion   VARCHAR(100)   
  esGratuito  BOOLEAN
  latitud     coordenada_t,
  longitud    coordenada_t,
  tieneServicio REF Servicio_t,
  tiene REF hito_t
  


 CONSTRAINT cont_sercat CHECK( categoría IN (salud, entretenimiento, comida, transporte, estacion de servicio, otros))

);[NOT FINAL]

  CREATE TABLE servicio_table OF servicio_t;


 CREATE OR REPLACE TYPE rutafija_t AS OBJECT (
 
 incluye REF paquete
  );
  
 CREATE TABLE rutafija_table OF rutafija_t;



 CREATE OR REPLACE TYPE rutadinamica_t AS OBJECT (
 propuestaFija BOOLEAN 

  );
  
 CREATE TABLE rutadinamica_table OF rutadinamica_t;







  
  CREATE OR REPLACE TYPE paquete_t AS OBJECT UNDER servicio_t (
  nombre          VARCHAR(100),
  costoEstudiante 
  costoEstandar
  costoTerceraEdad 
  costoNino      
  descripcion    TEXT
  incluye REF ruta_t);
  
  CREATE TABLE paquete_table OF paquete_t;


  --CREATE TABLE usuario_t AS OBJECT(
  
  --alias   VARCHAR(100)
  --nombres ..PODRIAMOS CREAR UN TYPE NOMBRE QUE TENGA YA NOMBRE Y APELLIDO...
  --apellidos
  --email
  --contrasena       
  --genero           VARCHAR(20)
  --fechaNacimiento  DATE,
  --esEstudiante     BOOLEAN,
  --interes          
  --biografia        TEXT);
  


  CREATE OR REPLACE  TABLE valoracion_t AS OBJECT (
  
  nivelSeguridad  INTEGER(10),
  relacionPrecioValor INTEGER(10),
  puntuacion          INTEGER(10),
  comentario   TEXT,
  CONSTRAINT cont_seguridad CHECK( nivelSeguridad IN (1,2,3,4,5)),
  CONSTRAINT cont_precioval CHECK( relacionPrecioValor IN (1,2,3,4,5)),
  CONSTRAINT cont_puntu CHECK( puntuacion IN (1,2,3,4,5)));

  CREATE TABLE valoracion_table OF valoracion_t;

------ PARTE 2



CREATE OR REPLACE TYPE Contiene AS OBJECT (
hito_table REF hito_t);






CREATE OR REPLACE TYPE Contrata AS OBJECT (
  --tipo VARCHAR(30) -- Multivaluado 
  numero INTEGER(20)
  paquete  REF paquete_t
  usuario REF usuario_t);
 

CREATE TABLE contrata_in OF Contrata(

foreign key(paquete) references paquete_table, foreign key (usuario) references usuario_table); 


-- Duda…es 1:N pero se creo porque tiene argumentos :/
CREATE OR REPLACE TYPE Ocurre AS OBJECT (
  FechaInicio DATE
  FechaFin DATE
  evento REF evento_t
  hito   REF hito_t);

CREATE TABLE Ocurre_table OF Ocurre (

foreign key(evento) references evento_table, foreign key (hito) references hito_table
)
  

CREATE OR REPLACE TYPE ValoraCiudad AS OBJECT (
usuario REF usuario_t
valoracion valoracion_t
ciudad Ciudad_T

CREATE TABLE ValoraCiudad_table OF Ocurre (

foreign key(usuario) references usuario_table, foreign key (valoracion) references valoracion_table
foreign key (ciudad) references Ciudad_table
)




CREATE OR REPLACE TYPE ValoraHito AS OBJECT(
usuario REF usuario_t
valoracion REF valoracion_t
hito REF hito_T

CREATE TABLE ValoraHito_table OF Ocurre (

foreign key(usuario) references usuario_table, foreign key (valoracion) references valoracion_table
foreign key (hito) references hito_table
)

CREATE OR REPLACE TYPE ValoraRuta AS OBJECT(
REF usuario_t
REF valoracion_t
REF ruta_t

CREATE TABLE ValoraRuta_table OF Ocurre (

foreign key(usuario) references usuario_table, foreign key (valoracion) references valoracion_table
foreign key (ruta) references ruta_table
)


--Problemas con la generalizacion
--CREATE OR REPLACE TYPE Incluye AS OBJECT(
--  REF paquete_t
--  REF ruta_t  -- Especificar que es de tipo= fija
 
 --- NI IDEA PORQUE HAY UN DUDA CON LA GENERALIZACION
--CREATE OR REPLACE TYPE Crea AS OBJECT(

--  REF usuario_t
--  REF ruta_t
-)  

-- No se crea porque es 1:n
--CREATE OR REPLACE TYPE EstaEn AS OBJECT(
--  REF ruta_t
--  REF Ciudad_t
-- No se crea porque es 1:n
CREATE OR REPLACE TYPE SeEncuentra AS OBJECT(
  REF via_t
  REF Ciudad_T


-- GENERALIZACION PROBLEMAS NI IDEA. PREGUNTAR
--CREATE OR REPLACE TYPE Toma AS OBJECT(
--  REF usuario_T
--  REF ruta_t
--  EsAprobada BOOLEAN
--  HoraInicio: TIME
--  HoraFin: TIME


CREATE OR REPLACE TYPE Tiene AS OBJECT(
  hito REF hito_t
  servicio REF servicio_t
  
  );
  
 CREATE TABLE Tiene_table OF Tiene(
 
 foreign key(hito) references hito_table, 
 foreign key (servicio) references servicio_table); 
  

CREATE TABLE TieneServicio_table OF TieneServicio(
 
 foreign key(servicio) references servicio_table, 
 foreign key (via) references via_table); 
  
CREATE OR REPLACE TYPE SeAccedePor AS OBJECT(
  hito REF hito_t
  via  REF via_t

CREATE TABLE SeAccedePor_table OF SeAccedePor(
 
 foreign key(hito) references hito_table, 
 foreign key (via) references via_table); 


-- No se crea porque es N:1
CREATE OR REPLACE TYPE RutaEn AS OBJECT(
  REF hito_t


-- No se crea porque es N:1
CREATE OR REPLACE ES TYPE AS OBJECT
  REF via_t
  REF hito_t


  



  
  
  
